$integration: 'http://ibm.com/appconnect/integration/v2/integrationFile'
integration:
  type: trigger-action
  trigger-interfaces:
    trigger-interface-1:
      type: event-trigger
      triggers:
        CREATED:
          input-context:
            data: Event
          assembly:
            $ref: '#/integration/assemblies/assembly-1'
          options: {}
      connector-type: eventbrite
  action-interfaces:
    action-interface-1:
      type: api-action
      business-object: employees
      connector-type: netsuitehc
      actions:
        RETRIEVEALL: {}
    action-interface-2:
      type: api-action
      business-object: message
      connector-type: slack
      actions:
        CREATE: {}
  assemblies:
    assembly-1:
      assembly:
        execute:
          - retrieve-action:
              name: NetSuite HCM Retrieve employees
              target:
                $ref: '#/integration/action-interfaces/action-interface-1'
              filter:
                where:
                  eligibleForCommission: 'true'
                input:
                  - variable: Trigger
                    $ref: '#/trigger/payload'
                limit: 20
              allow-empty-output: false
              allow-truncation: true
          - create-action:
              name: Slack Create message
              target:
                $ref: '#/integration/action-interfaces/action-interface-2'
              map:
                mappings:
                  - channel:
                      template: C4GHPM484
                  - text:
                      template: >-
                        You are invited to event {{$Trigger.name.html}}
                        {{$Trigger.url}}
                $map: 'http://ibm.com/appconnect/map/v1'
                input:
                  - variable: Trigger
                    $ref: '#/trigger/payload'
                  - variable: NetSuiteHCMRetrieveemployees
                    $ref: >-
                      #/node-output/NetSuite HCM Retrieve
                      employees/response/payload
                  - variable: NetSuiteHCMRetrieveemployeesMetadata
                    $ref: '#/node-output/NetSuite HCM Retrieve employees/response'
  name: Invite Sales employees to an Eventbrite event
  description: >-
    This template retrieves details of your Sales staff from NetSuite HCM when a
    new event is created in Eventbrite.  It then sends them a message on Slack
    to invite them to the event.
  todo: >
    To refer to these instructions while editing the flow, open [the github
    page](https://github.com/ot4i/app-connect-templates/blob/master/resources/markdown/Invite%20Sales%20employees%20to%20an%20Eventbrite%20event_instructions.md)
    (opens in a new window).


    1. Click **Create flow** to start using the template.

    1. Connect to your [Eventbrite
    account](https://developer.ibm.com/integration/docs/app-connect/how-to-guides-for-apps/use-ibm-app-connect-eventbrite/).

    1. Connect to your NetSuite HCM account and, if necessary, change the
    criteria for selecting your employees.

    1. Connect to your [Slack
    account](https://developer.ibm.com/integration/docs/app-connect/how-to-guides-for-apps/use-ibm-app-connect-slack/)
    and select the Slack channel where you want to post your message, and update
    the text of the message if you want to.

    1. To start the flow, in the banner open the options menu [&#8942;] then
    click **Start flow**.
models: {}
