$integration: 'http://ibm.com/appconnect/integration/v2/integrationFile'
integration:
  type: trigger-action
  trigger-interfaces:
    trigger-interface-1:
      type: event-trigger
      triggers:
        CREATED:
          input-context:
            data: Attendee
          assembly:
            $ref: '#/integration/assemblies/assembly-1'
      connector-type: eventbrite
  action-interfaces:
    action-interface-1:
      type: api-action
      business-object: Lead
      connector-type: insightly
      actions:
        CREATE: {}
    action-interface-2:
      type: api-action
      business-object: Members
      connector-type: mailchimp
      actions:
        CREATE: {}
  assemblies:
    assembly-1:
      assembly:
        execute:
          - create-action:
              name: Insightly Create lead
              target:
                $ref: '#/integration/action-interfaces/action-interface-1'
              map:
                mappings:
                  - EMAIL_ADDRESS:
                      template: '{{$Trigger.profile.email}}'
                  - FIRST_NAME:
                      template: '{{$Trigger.profile.first_name}}'
                  - LAST_NAME:
                      template: '{{$Trigger.profile.last_name}}'
                  - LEAD_DESCRIPTION:
                      template: 'Attendee at {{$Trigger.event_id}}'
                $map: 'http://ibm.com/appconnect/map/v1'
                input:
                  - variable: Trigger
                    $ref: '#/trigger/payload'
          - create-action:
              name: MailChimp Add subscriber to a list
              target:
                $ref: '#/integration/action-interfaces/action-interface-2'
              map:
                mappings:
                  - email_address:
                      template: '{{$Trigger.profile.email}}'
                  - list_id:
                      template: 4b987b8188
                  - merge_fields:
                      mappings:
                        - FNAME:
                            template: '{{$Trigger.profile.first_name}}'
                        - LNAME:
                            template: '{{$Trigger.profile.last_name}}'
                $map: 'http://ibm.com/appconnect/map/v1'
                input:
                  - variable: Trigger
                    $ref: '#/trigger/payload'
                  - variable: InsightlyCreatelead
                    $ref: '#/node-output/Insightly Create lead/response/payload'
  name: Add attendee to Insightly and MailChimp
  description: >-
    This template creates an Insightly lead when someone registers for an event
    in Eventbrite and additionally subscribes the attendee to a MailChimp
    campaign list.
  todo: >
    To refer to these instructions while editing the flow, open [the github
    page](https://github.com/ot4i/app-connect-templates/blob/master/resources/markdown/Add%20attendee%20to%20Insightly%20and%20MailChimp_instructions.md)
    (opens in a new window).


    1. Click **Create flow** to start using the template.

    1. Connect to your [Eventbrite
    account](https://developer.ibm.com/integration/docs/app-connect/how-to-guides-for-apps/use-ibm-app-connect-eventbrite/).

    1. Connect to your [Insightly
    account](https://developer.ibm.com/integration/docs/app-connect/how-to-guides-for-apps/use-ibm-app-connect-insightly/).

    1. Connect to your [MailChimp
    account](https://developer.ibm.com/integration/docs/app-connect/how-to-guides-for-apps/use-ibm-app-connect-mailchimp/).

    1. Click on the MailChimp node and select the list where the attendee needs
    to be added.

    1. To start the flow, in the banner open the options menu [&#8942;] then
    click **Start flow**.


    Want to see the flow working? Add a new attendee to your Eventbrite event,
    and then check Insightly and MailChimp to see that the attendee has been
    added to those applications.


    For more information about this template and to view the associated
    tutorial, see [Creating an event-driven flow that adds attendees for an
    Eventbrite event as Insightly leads and MailChimp list
    subscribers](https://developer.ibm.com/integration/docs/app-connect/tutorials-for-ibm-app-connect/creating-event-driven-flow-adds-attendees-eventbrite-event-insightly-leads-mailchimp-list-subscribers/).
models: {}
